<html>
<head>
    <title>Create Team</title>
    <link rel="stylesheet" href="styles.css">
    <script src="app.js"></script>
</head>
<body>
<div class="header">
    <div class="title">CricForge</div>
    <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<div class="container">
    <h2>Create Team</h2>

    <div class="error" id="error"></div>

    <input id="name" placeholder="Team Name">

    <h3>Players</h3>
    <div id="players"></div>

    <button onclick="addPlayer()">Add Player</button>
    <button onclick="submitTeam()">Create</button>
</div>

<script>
    let playerList = [];

    function addPlayer() {
        const idx = playerList.length;
        playerList.push({});

        players.innerHTML += `
            <div class="card">
                <input placeholder="First Name" id="pfn${idx}">
                <input placeholder="Last Name" id="pln${idx}">
                <input placeholder="Role" id="prole${idx}">
                <select id="ptype${idx}">
                    <option value="NORMAL">Normal</option>
                    <option value="CAPTAIN">Captain</option>
                    <option value="VICE_CAPTAIN">Vice Captain</option>
                </select>
            </div>
        `;
    }

    async function submitTeam() {
        try {
            const finalPlayers = playerList.map((_, i) => ({
                firstName: document.getElementById(`pfn${i}`).value,
                lastName: document.getElementById(`pln${i}`).value,
                role: document.getElementById(`prole${i}`).value,
                type: document.getElementById(`ptype${i}`).value
            }));

            await api('/teams', 'POST', {
                name: document.getElementById('name').value,
                players: finalPlayers
            });

            window.location = "teams.html";
        } catch (err) {
        showError(err.message);
    }
    }
</script>

</body>
</html>
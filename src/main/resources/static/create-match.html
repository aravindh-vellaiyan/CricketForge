<html>
<head>
    <title>Create Match</title>
    <link rel="stylesheet" href="styles.css">
    <script src="app.js"></script>
</head>

<body>

<div class="header">
    <div class="title">CricForge</div>
    <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<div class="container">
    <h2>Create Match</h2>

    <div class="error" id="error"></div>

    <label>Team A</label>
    <select id="teamA"></select>

    <label>Team B</label>
    <select id="teamB"></select>

    <label>Overs</label>
    <input id="overs" type="number">

    <button onclick="createMatch()">Create Match</button>
</div>

<!-- JS MUST BE AT BOTTOM -->
<script>
    let allTeams = [];

    async function loadTeams() {
        try {
            allTeams = await api('/teams');
            console.log("Loaded teams:", allTeams);
            populateDropdowns();
        } catch (err) {
            showError(err.message);
        }
    }

    function populateDropdowns() {
        const teamA = document.getElementById("teamA");
        const teamB = document.getElementById("teamB");

        teamA.innerHTML = allTeams
            .map(t => `<option value="${t.id}">${t.name}</option>`)
            .join('');

        teamB.innerHTML = allTeams
            .map(t => `<option value="${t.id}">${t.name}</option>`)
            .join('');

        filterTeams();
    }

    function filterTeams() {
        const A = Number(teamA.value);
        const B = Number(teamB.value);

        teamA.innerHTML = allTeams
            .filter(t => t.id !== B)
            .map(t => `<option value="${t.id}">${t.name}</option>`)
            .join('');

        teamB.innerHTML = allTeams
            .filter(t => t.id !== A)
            .map(t => `<option value="${t.id}">${t.name}</option>`)
            .join('');
    }

    document.addEventListener("DOMContentLoaded", loadTeams);
</script>

</body>
</html>